<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>(M)ANOVA Permutation Test — anova_test • flipr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="(M)ANOVA Permutation Test — anova_test"><meta name="description" content="This function carries out an hypothesis test in which the null hypothesis is
that K samples are governed by the same underlying generative probability
distribution against the alternative hypothesis that they are governed by
different generative probability distributions."><meta property="og:description" content="This function carries out an hypothesis test in which the null hypothesis is
that K samples are governed by the same underlying generative probability
distribution against the alternative hypothesis that they are governed by
different generative probability distributions."><meta property="og:image" content="https://permaverse.github.io/flipr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flipr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/flipr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/alternative.html">The alternative hypothesis in permutation testing</a></li>
    <li><a class="dropdown-item" href="../articles/anova.html">Performing ANOVA</a></li>
    <li><a class="dropdown-item" href="../articles/exactness.html">On the exactness of permutation tests</a></li>
    <li><a class="dropdown-item" href="../articles/parallelization.html">Parallel processing</a></li>
    <li><a class="dropdown-item" href="../articles/plausibility.html">Computing plausibility functions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/permaverse/flipr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>(M)ANOVA Permutation Test</h1>
      <small class="dont-index">Source: <a href="https://github.com/permaverse/flipr/blob/master/R/anova-test.R" class="external-link"><code>R/anova-test.R</code></a></small>
      <div class="d-none name"><code>anova_test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function carries out an hypothesis test in which the null hypothesis is
that K samples are governed by the same underlying generative probability
distribution against the alternative hypothesis that they are governed by
different generative probability distributions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anova_test</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">memberships</span>,</span>
<span>  stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">stat_anova_f_ip</span><span class="op">)</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  M <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"right_tail"</span>,</span>
<span>  combine_with <span class="op">=</span> <span class="st">"tippett"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"exact"</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A numeric vector or a numeric matrix or a list specifying the
pooled data points. Alternatively, it can be a distance matrix stored as an
object of class <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist</a></code>, in which case test statistics
based on inter-point distances (marked with the <code>_ip</code> suffix) should be
used.</p></dd>


<dt id="arg-memberships">memberships<a class="anchor" aria-label="anchor" href="#arg-memberships"></a></dt>
<dd><p>An integer vector specifying the original membership of
each data point.</p></dd>


<dt id="arg-stats">stats<a class="anchor" aria-label="anchor" href="#arg-stats"></a></dt>
<dd><p>A list of functions produced by <code><a href="https://rlang.r-lib.org/reference/as_function.html" class="external-link">rlang::as_function()</a></code>
specifying the chosen test statistic(s). A number of test statistic
functions are implemented in the package and can be used as such.
Alternatively, one can provide its own implementation of test statistics
that (s)he deems relevant for the problem at hand. See the section
<em>User-supplied statistic function</em> for more information on how these
user-supplied functions should be structured for compatibility with the
<strong>flipr</strong> framework. Defaults to <code>list(stat_anova_f_ip)</code>.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>The number of sampled permutations. Default is <code>1000L</code>.</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>The total number of possible permutations. Defaults to <code>NULL</code>, which
means that it is automatically computed from the given sample size(s).</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>A single string or a character vector specifying whether
the p-value is right-tailed, left-tailed or two-tailed. Choices are
<code>"right_tail"</code>, <code>"left_tail"</code> and <code>"two_tail"</code>. Default is <code>"two_tail"</code>. If
a single string is provided, it is assumed that it should be applied to all
test statistics provided by the user. Alternative, the length of
<code>alternative</code> should match the length of the <code>stats</code> parameter and it is
assumed that there is a one-to-one correspondence. Defaults to
<code>"right_tail"</code>.</p></dd>


<dt id="arg-combine-with">combine_with<a class="anchor" aria-label="anchor" href="#arg-combine-with"></a></dt>
<dd><p>A string specifying the combining function to be used to
compute the single test statistic value from the set of p-value estimates
obtained during the non-parametric combination testing procedure. For now,
choices are either <code>"tippett"</code> or <code>"fisher"</code>. Defaults to <code>"tippett"</code>,
which picks Tippett's function.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A string specifying which formula should be used to compute the
p-value. Choices are <code>exact</code>, <code>upper_bound</code> and <code>estimate</code>. See Phipson &amp;
Smith (2010) for details. Defaults to <code>"exact"</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>An integer specifying the seed of the random generator useful for
result reproducibility or method comparisons. Default is <code>NULL</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Extra parameters specific to some statistics.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">base::list</a></code> with 4 components:</p><ul><li><p><code>observed</code>: the value of the (possible combined) test statistic(s) using
the original memberhips of data points;</p></li>
<li><p><code>pvalue</code>: the permutation p-value;</p></li>
<li><p><code>null_distribution</code>: the values of the (possible combined) test statistic(s)
using the permuted memberhips of data points;</p></li>
<li><p><code>permutations</code>: the permutations that were effectively sampled to produce
the null distribution.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="user-supplied-statistic-function">User-supplied statistic function<a class="anchor" aria-label="anchor" href="#user-supplied-statistic-function"></a></h2>


<p>A user-specified function should have at least two arguments:</p><ul><li><p>the first argument should be either a list of the <code>n</code> pooled data points or
a dissimilarity matrix stored as a <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist</a></code> object.</p></li>
<li><p>the second argument shoud be an integer vector specifying the (possibly
permuted) membership of each data point.</p></li>
</ul><p>See the <code><a href="anova-stats.html">stat_anova_f()</a></code> function for an example.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">out1</span> <span class="op">&lt;-</span> <span class="fu">anova_test</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">chickwts</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  memberships <span class="op">=</span> <span class="va">chickwts</span><span class="op">$</span><span class="va">feed</span>,</span></span>
<span class="r-in"><span>  stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">stat_anova_f_ip</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out1</span><span class="op">$</span><span class="va">pvalue</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.000999001</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu">anova_test</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">chickwts</span><span class="op">$</span><span class="va">weight</span>,</span></span>
<span class="r-in"><span>  memberships <span class="op">=</span> <span class="va">chickwts</span><span class="op">$</span><span class="va">feed</span>,</span></span>
<span class="r-in"><span>  stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">stat_anova_f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out2</span><span class="op">$</span><span class="va">pvalue</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.000999001</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alessia Pini, Aymeric Stamm, Simone Vantini.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

