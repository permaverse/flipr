<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Performing ANOVA ‚Ä¢ flipr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="anova_files/libs/quarto-html/popper.min.js"></script><script src="anova_files/libs/quarto-html/tippy.umd.min.js"></script><link href="anova_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="anova_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Performing ANOVA">
<meta property="og:image" content="https://permaverse.github.io/flipr/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flipr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/flipr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/alternative.html">The alternative hypothesis in permutation testing</a></li>
    <li><a class="dropdown-item" href="../articles/anova.html">Performing ANOVA</a></li>
    <li><a class="dropdown-item" href="../articles/exactness.html">On the exactness of permutation tests</a></li>
    <li><a class="dropdown-item" href="../articles/parallelization.html">Parallel processing</a></li>
    <li><a class="dropdown-item" href="../articles/plausibility.html">Computing plausibility functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/permaverse/flipr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Performing ANOVA</h1>




      <small class="dont-index">Source: <a href="https://github.com/permaverse/flipr/blob/master/vignettes/anova.qmd" class="external-link"><code>vignettes/anova.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <p>The package allows user to perform (M)-ANOVA. Two examples are shown in this article for more clarity. User can pass data in the plausibility function as two possible formats:</p>
<ul>
<li>An object with all samples and a factor containing group memberships.</li>
<li>Each sample representing a group.</li>
</ul>
<p>Both cases will appear in this article. Since we use Fisher tests, it is important to change the <code>alternative</code> parameter of the plausibility function to <code>right_tail</code>.</p>
<section class="level2"><h2 id="plausibility-function-for-1-anova">Plausibility function for 1-ANOVA üêì<a class="anchor" aria-label="anchor" href="#plausibility-function-for-1-anova"></a>
</h2>
<p>For this example, data represent chicken weights by feed type. There are three populations that have been fed different types of food. The null hypothesis is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>Œº</mi><mn>1</mn></msub><mo>=</mo><msub><mi>Œº</mi><mn>2</mn></msub><mo>=</mo><msub><mi>Œº</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">
H_0: \mu_1 = \mu_2 = \mu_3
</annotation></semantics></math></p>
<p>with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œº</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mu_i</annotation></semantics></math> representing the sample mean in the group <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">chickwts</span><span class="op">$</span><span class="va">weight</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">36</span><span class="op">]</span> <span class="co"># 1 variable</span></span>
<span><span class="va">memberships</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">chickwts</span><span class="op">$</span><span class="va">feed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">36</span><span class="op">]</span><span class="op">)</span> <span class="co"># 1 factor with 3 populations</span></span>
<span></span>
<span><span class="co"># takes all samples except the first one</span></span>
<span><span class="va">null_spec</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">l</span>, <span class="va">parameters</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">l</span>, <span class="va">parameters</span>, \<span class="op">(</span><span class="va">l</span>, <span class="va">param</span><span class="op">)</span> <span class="va">l</span> <span class="op">-</span> <span class="va">param</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">stat_functions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">stat_anova_f</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all means except first one</span></span>
<span><span class="va">stat_assignments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu2 <span class="op">=</span> <span class="fl">1</span>, mu3 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PlausibilityFunction.html">PlausibilityFunction</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  null_spec <span class="op">=</span> <span class="va">null_spec</span>,</span>
<span>  stat_functions <span class="op">=</span> <span class="va">stat_functions</span>,</span>
<span>  stat_assignments <span class="op">=</span> <span class="va">stat_assignments</span>,</span>
<span>  <span class="va">data</span>, <span class="va">memberships</span></span>
<span><span class="op">)</span></span>
<span><span class="va">pf</span><span class="op">$</span><span class="fu">set_alternative</span><span class="op">(</span><span class="st">"right_tail"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pvalue1</span> <span class="op">&lt;-</span> <span class="va">pf</span><span class="op">$</span><span class="fu">get_value</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvalue1</span></span>
<span><span class="co">#&gt; [1] 0.002997003</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">memberships</span><span class="op">)</span><span class="op">)</span>, \<span class="op">(</span><span class="va">.class</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">memberships</span><span class="op">)</span> <span class="op">==</span> <span class="va">.class</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samples</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samples</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pvalue1_est</span> <span class="op">&lt;-</span> <span class="va">pf</span><span class="op">$</span><span class="fu">get_value</span><span class="op">(</span><span class="va">means</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvalue1_est</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pf</span><span class="op">$</span><span class="fu">set_point_estimate</span><span class="op">(</span><span class="va">means</span><span class="op">)</span></span>
<span><span class="va">point_estimate1</span> <span class="op">&lt;-</span> <span class="va">pf</span><span class="op">$</span><span class="va">point_estimate</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">point_estimate1</span></span>
<span><span class="co">#&gt;      mu2      mu3 </span></span>
<span><span class="co">#&gt; 58.55000 86.22857</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pf</span><span class="op">$</span><span class="fu">set_parameter_bounds</span><span class="op">(</span></span>
<span>  point_estimate <span class="op">=</span> <span class="va">pf</span><span class="op">$</span><span class="va">point_estimate</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="va">pf</span><span class="op">$</span><span class="va">max_conf_level</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pf</span><span class="op">$</span><span class="fu">set_grid</span><span class="op">(</span></span>
<span>  parameters <span class="op">=</span> <span class="va">pf</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>  npoints <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="va">pf</span><span class="op">$</span><span class="fu">evaluate_grid</span><span class="op">(</span>grid <span class="op">=</span> <span class="va">pf</span><span class="op">$</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="va">grid1</span> <span class="op">&lt;-</span> <span class="va">pf</span><span class="op">$</span><span class="va">grid</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">mu2</span>, <span class="va">mu3</span>, z <span class="op">=</span> <span class="va">pvalue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_contour_filled</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Contour plot of the p-value surface"</span>, </span>
<span>    subtitle <span class="op">=</span> <span class="st">"Using Fisher's non-parametric combination"</span>, </span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">mu</span>, <span class="st">"_2"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">mu</span>, <span class="st">"_3"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    fill <span class="op">=</span> <span class="st">"p-value"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="anova_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h2 id="plausibility-function-for-2-anova">Plausibility function for 2-ANOVA üå∏<a class="anchor" aria-label="anchor" href="#plausibility-function-for-2-anova"></a>
</h2>
<p>In this example, data used represent flower caracteristics by their specie. The variables are sepal length and sepal width that are compared bewteen three different flower species. The null hypothesis is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œº</mi><mn>11</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œº</mi><mn>12</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œº</mi><mn>21</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œº</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œº</mi><mn>31</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œº</mi><mn>32</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
H_0: \begin{pmatrix}
\mu_{11} \\
\mu_{12}
\end{pmatrix}
=
\begin{pmatrix}
\mu_{21} \\
\mu_{22}
\end{pmatrix}
=
\begin{pmatrix}
\mu_{31} \\
\mu_{32}
\end{pmatrix}
</annotation></semantics></math></p>
<p>with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œº</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\mu_{ij}</annotation></semantics></math> representing the sample mean in the group <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> for the variable <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris_setosa</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"setosa"</span><span class="op">)</span></span>
<span><span class="va">iris_setosa</span> <span class="op">&lt;-</span> <span class="va">iris_setosa</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">iris_versicolor</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"versicolor"</span><span class="op">)</span></span>
<span><span class="va">iris_versicolor</span> <span class="op">&lt;-</span> <span class="va">iris_versicolor</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">iris_virginica</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"virginica"</span><span class="op">)</span></span>
<span><span class="va">iris_virginica</span> <span class="op">&lt;-</span> <span class="va">iris_virginica</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># takes all samples except the first one</span></span>
<span><span class="va">null_spec</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">l</span>, <span class="va">parameters</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">parameters</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">l</span>, <span class="va">parameters</span>, \<span class="op">(</span><span class="va">group</span>, <span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">params</span>, \<span class="op">(</span><span class="va">var</span>, <span class="va">param</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">var</span> <span class="op">-</span> <span class="va">param</span></span>
<span>    <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">stat_functions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">stat_anova_f</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all means except ones from first sample</span></span>
<span><span class="va">stat_assignments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  mu2_1 <span class="op">=</span> <span class="fl">1</span>, mu2_2 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mu3_1 <span class="op">=</span> <span class="fl">1</span>, mu3_2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PlausibilityFunction.html">PlausibilityFunction</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  null_spec <span class="op">=</span> <span class="va">null_spec</span>,</span>
<span>  stat_functions <span class="op">=</span> <span class="va">stat_functions</span>,</span>
<span>  stat_assignments <span class="op">=</span> <span class="va">stat_assignments</span>,</span>
<span>  <span class="va">iris_setosa</span>, <span class="va">iris_versicolor</span>, <span class="va">iris_virginica</span></span>
<span><span class="op">)</span></span>
<span><span class="va">pf</span><span class="op">$</span><span class="fu">set_alternative</span><span class="op">(</span><span class="st">"right_tail"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pvalue2</span> <span class="op">&lt;-</span> <span class="va">pf</span><span class="op">$</span><span class="fu">get_value</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvalue2</span></span>
<span><span class="co">#&gt; [1] 0.000999001</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">iris_versicolor</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">iris_setosa</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">iris_versicolor</span><span class="op">$</span><span class="va">Sepal.Width</span><span class="op">)</span>  <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">iris_setosa</span><span class="op">$</span><span class="va">Sepal.Width</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">iris_virginica</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">iris_setosa</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">iris_virginica</span><span class="op">$</span><span class="va">Sepal.Width</span><span class="op">)</span>  <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">iris_setosa</span><span class="op">$</span><span class="va">Sepal.Width</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">pvalue1_est</span> <span class="op">&lt;-</span> <span class="va">pf</span><span class="op">$</span><span class="fu">get_value</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvalue1_est</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pf</span><span class="op">$</span><span class="fu">set_point_estimate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">point_estimate2</span> <span class="op">&lt;-</span> <span class="va">pf</span><span class="op">$</span><span class="va">point_estimate</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">point_estimate2</span></span>
<span><span class="co">#&gt; mu2_1 mu2_2 mu3_1 mu3_2 </span></span>
<span><span class="co">#&gt;  1.24 -0.44  1.71 -0.37</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pf</span><span class="op">$</span><span class="fu">set_parameter_bounds</span><span class="op">(</span></span>
<span>  point_estimate <span class="op">=</span> <span class="va">pf</span><span class="op">$</span><span class="va">point_estimate</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="va">pf</span><span class="op">$</span><span class="va">max_conf_level</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pf</span><span class="op">$</span><span class="fu">set_grid</span><span class="op">(</span></span>
<span>  parameters <span class="op">=</span> <span class="va">pf</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>  npoints <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="va">pf</span><span class="op">$</span><span class="fu">evaluate_grid</span><span class="op">(</span>grid <span class="op">=</span> <span class="va">pf</span><span class="op">$</span><span class="va">grid</span><span class="op">)</span></span>
<span></span>
<span><span class="va">grid2</span> <span class="op">&lt;-</span> <span class="va">pf</span><span class="op">$</span><span class="va">grid</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid2</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pvalue</span> <span class="op">&gt;</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 √ó 5</span></span>
<span><span class="co">#&gt;   mu2_1 mu2_2 mu3_1 mu3_2 pvalue</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  1.24 -0.44  1.71 -0.37      1</span></span></code></pre></div>
</div>
</section><section class="level2"><h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>For these two examples, means are different in each population. Thus, when we test the equality of means with <code>get_value(0)</code>, we get a pvalue close to 0, allowing us to reject the hypothesis that the means are equal within the different populations. On the other hand, if we get the pvalue for the test on the estimator values, it is equal to 1, the largest possible value, which is coherent.</p>
</section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alessia Pini, Aymeric Stamm, Simone Vantini.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
